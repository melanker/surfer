var SurfInfo={};SurfInfo.getTime=function(a){var t=function(a){return 10>a&&(a="0"+a),a},e=new Date(a),n=t(e.getHours()),r=t(e.getMinutes());return n+":"+r},$(function(){SurfInfo.initCity=function(){var a,t,e={},n=this,r=$(".loading");a=function(){var a=$(".weatherCurrent");a.find(".cloudsImg").css("background","url(/public/assets/img/"+e.weather[0].icon+".png) no-repeat"),a.find(".temp").html(e.main.temp.toPrecision(4)+"&deg"),e.windSpeedKnots=(1.94384*e.wind.speed).toPrecision(4),"Haifa"===SurfInfo.webApp.locationPath||"Nahariya"===SurfInfo.webApp.locationPath?(e.waveHeight=SurfInfo.webApp.charts.haifaData.data.hS[SurfInfo.webApp.charts.haifaData.data.hS.length-1],a.find(".seaTemp").html(parseFloat(SurfInfo.webApp.charts.haifaData.data.temperature[SurfInfo.webApp.charts.haifaData.data.temperature.length-1])+"&deg")):"Ashdod"===SurfInfo.webApp.locationPath?(e.waveHeight=SurfInfo.webApp.charts.ashdodData.data.hS[SurfInfo.webApp.charts.ashdodData.data.hS.length-1],a.find(".seaTemp").html(parseFloat(SurfInfo.webApp.charts.ashdodData.data.temperature[SurfInfo.webApp.charts.ashdodData.data.temperature.length-1])+"&deg")):(e.waveHeight=((parseFloat(SurfInfo.webApp.charts.ashdodData.data.hS[SurfInfo.webApp.charts.ashdodData.data.hS.length-1])+parseFloat(SurfInfo.webApp.charts.haifaData.data.hS[SurfInfo.webApp.charts.haifaData.data.hS.length-1]))/2).toPrecision(3),a.find(".seaTemp").html(((parseFloat(SurfInfo.webApp.charts.ashdodData.data.temperature[SurfInfo.webApp.charts.ashdodData.data.temperature.length-1])+parseFloat(SurfInfo.webApp.charts.haifaData.data.temperature[SurfInfo.webApp.charts.haifaData.data.temperature.length-1]))/2).toPrecision(4)+"&deg")),a.find(".waves").text(e.waveHeight+"m"),a.find(".speed").text((1.94384*e.wind.speed).toPrecision(4)+" קשר"),a.find(".direction").css({background:"url(/public/assets/img/wa-sprite.png) -50px -1040px no-repeat","-webkit-transform":"rotate("+e.wind.deg+"deg)","-moz-transform":"rotate("+e.wind.deg+"deg)","-ms-transform":"rotate("+e.wind.deg+"deg)",transform:"rotate("+e.wind.deg+"deg)"}),a.find(".sunset").text(SurfInfo.getTime(1e3*e.sys.sunset)),a.find(".sunrise").text(SurfInfo.getTime(1e3*e.sys.sunrise)),a.show()},t=function(){var a,t,n="",i="",s=$(".details"),o=$("#imgStat");switch(e.wind.deg>=80&&e.wind.deg<=100?(a="מזרחית",i="רוח מזרחית עלולה להשטיח את הגל"):e.wind.deg>100&&e.wind.deg<170?a="דרומית מזרחית":e.wind.deg>=170&&e.wind.deg<=190?(a="דרומית",i="קחו לתשומת ליבכם שרוח דרומית הינה בעלת השפעה קטנה על הגל"):e.wind.deg>190&&e.wind.deg<260?a="מערבית דרומית":e.wind.deg>=260&&e.wind.deg<=280?a="מערבית":e.wind.deg>280&&e.wind.deg<360?a="מערבית צפונית":e.wind.deg>=360||e.wind.deg>=0&&e.wind.deg<=10?(a="צפונית",i="קחו לתשומת ליבכם שרוח צפונית הינה בעלת השפעה קטנה על הגל"):a="צפונית מזרחית",!0){case e.windSpeedKnots<=7:t="רוח חלשה";break;case e.windSpeedKnots>7&&e.windSpeedKnots<10:t="רוח בינונית";break;case e.windSpeedKnots>=10&&e.windSpeedKnots<13:t="רוח בינונית חזקה";break;case e.windSpeedKnots>=13&&e.windSpeedKnots<16:t="רוח חזקה";break;case e.windSpeedKnots>=16:t="רוח חזקה מאוד"}e.waveHeight>=.8?e.windSpeedKnots<=7?(n="ים חלום. קחו חופש מחלה וצאו לים",o.attr("src","/public/assets/img/perfectWave.jpg")):e.windSpeedKnots>7&&e.windSpeedKnots<10?(n="הים עובד יופי, צריך עדיין להתחשב בכיוון הרוח ועוצמתה",o.attr("src","/public/assets/img/regWaves.jpg")):e.windSpeedKnots>10&&e.windSpeedKnots<16?(n="ים למנוסים, יש סיכוי לסחף ומכבסות עדיף חופים סגורים",o.attr("src","/public/assets/img/forPros.jpg")):(n="לא מומלץ לרדת לים",o.attr("src","/public/assets/img/chppyWaves.jpg")):e.waveHeight<.8&&e.waveHeight>=.5?e.windSpeedKnots<=7?(n="ים מצויין למתחילים עם לונג בורד",o.attr("src","/public/assets/img/longboardWave.jpg")):e.windSpeedKnots>7&&e.windSpeedKnots<10?(n="ים סביר, למתחילים עם לונג",o.attr("src","/public/assets/img/longboardWave.jpg")):(n="לא מומלץ, גל נמוך ורוח יחסית חזקה",o.attr("src","/public/assets/img/lowCrappyWaves.jpg")):(n="ים לחסקה",o.attr("src","/public/assets/img/hasake.jpg")),s.find("h1").text(n),s.find("p").text(t+" "+a+"\n"+i),r.hide()};!function(){n.communication.http("/api/"+SurfInfo.webApp.locationPath,"GET").then(function(n){r.show(),e=n.data,a(),t()},function(a){SurfInfo.initCity()})}()}}),$(function(){var a,t,e,n;a={ashdodChart:"#ashdodChart",haifaChart:"#haifaChart",ashdodStatus:".ashdodStatus",haifaStatus:".haifaStatus",upperNav:".upperNav"},SurfInfo.webApp={isMobile:!1,charts:{ashdodData:{loadingJq:$(".ashdodLoading"),title:"אשדוד",day:"",data:[]},haifaData:{loadingJq:$(".haifaLoading"),title:"חיפה",day:"",data:[]}}},t=function(t){var e=function(a){var t=[];if(!a||0===a.length)return[];for(var e=0;e<a.length;e+=1)t.push(parseFloat(a[e])||0);return t};$(a[t+"Chart"]).highcharts({chart:{type:"areaspline"},title:{text:(SurfInfo.webApp.charts[t+"Data"].data.date||"")+"  "+SurfInfo.webApp.charts[t+"Data"].title},xAxis:{categories:SurfInfo.webApp.charts[t+"Data"].data.time||[]},yAxis:{title:{text:"Height[meter]"}},tooltip:{shared:!0,valueSuffix:" meter"},credits:{enabled:!1},plotOptions:{areaspline:{fillOpacity:.5}},series:[{name:"גל מקסימלי",data:e(SurfInfo.webApp.charts[t+"Data"].data.hMax)||[]},{name:"גל ממוצע",data:e(SurfInfo.webApp.charts[t+"Data"].data.hS)||[]}]})},SurfInfo.communication={http:function(a,t){var e=$.Deferred();return $.ajax({url:a,crossDomain:!0,type:t,success:function(a){e.resolve(a)}}),e.promise()}},e=function(){var e,n,r;r=[],e=function(a){var t=$.Deferred();return r.push(t.promise()),SurfInfo.communication.http(a,"GET").then(function(a){t.resolve(a.data)}),t.promise()},n=function(e,n){var r=$(a[n+"Status"]+" .height"),i=$(a[n+"Status"]+" .date"),s=$(a[n+"Status"]+" .hour"),o=$(a[n+"Status"]+" .temp");SurfInfo.webApp.charts[n+"Data"].data=e,t(n),r.text(SurfInfo.webApp.charts[n+"Data"].data.hS[SurfInfo.webApp.charts[n+"Data"].data.hS.length-1]+"m - "+SurfInfo.webApp.charts[n+"Data"].data.hMax[SurfInfo.webApp.charts[n+"Data"].data.hMax.length-1]+"m"),i.text(SurfInfo.webApp.charts[n+"Data"].data.date),s.text(SurfInfo.webApp.charts[n+"Data"].data.time[SurfInfo.webApp.charts[n+"Data"].data.time.length-1]),o.html(SurfInfo.webApp.charts[n+"Data"].data.temperature[SurfInfo.webApp.charts[n+"Data"].data.temperature.length-1]+"&deg"),SurfInfo.webApp.charts[n+"Data"].loadingJq.hide()},e("/api/waves/ashdod").then(function(a){n(a,"ashdod")}),e("/api/waves/haifa").then(function(a){n(a,"haifa")}),SurfInfo.webApp.locationPath&&$.when.apply($,r).then(function(){SurfInfo.initCity()})},n=function(){var t=function(){var t,e=$(a.upperNav),n=e.find("li"),r=window.location.pathname.replace(/\//g,"");switch(SurfInfo.webApp.isMobile=!1,r.indexOf("mobile")>=0&&(SurfInfo.webApp.isMobile=!0,r=r.replace("mobile","")),SurfInfo.webApp.locationPath=r,e.find(".active").removeClass("active"),e.find(".ui-btn-active").removeClass("ui-btn-active ui-state-persist"),t=function(){SurfInfo.webApp.isMobile?this.find("a").addClass("ui-btn-active ui-state-persist"):this.tab("show")},r){case"Netanya":t.call(n.eq(2));break;case"Nahariya":t.call(n.eq(0));break;case"Haifa":t.call(n.eq(1));break;case"Herzliyya":t.call(n.eq(3));break;case"TelAviv":t.call(n.eq(4));break;case"Ashdod":t.call(n.eq(5));break;default:t.call(n.eq(6))}};t(),SurfInfo.webApp.charts.ashdodData.loadingJq.show(),SurfInfo.webApp.charts.haifaData.loadingJq.show(),e()}()});