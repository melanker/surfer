$(function(){var a,t,e,e,r;a={ashdodChart:"#ashdodChart",haifaChart:"#haifaChart",ashdodStatus:".ashdodStatus",haifaStatus:".haifaStatus",upperNav:".upperNav"},SurfInfo.webApp={isMobile:!1,charts:{ashdodData:{loadingJq:$(".ashdodLoading"),title:"אשדוד",day:"",data:[]},haifaData:{loadingJq:$(".haifaLoading"),title:"חיפה",day:"",data:[]}}},t=function(t){var e=SurfInfo.webApp.charts[t+"Data"].data.length,r=SurfInfo.webApp.charts[t+"Data"].data;SurfInfo.webApp.charts[t+"Data"].dataHmax=[],SurfInfo.webApp.charts[t+"Data"].dataHs=[],SurfInfo.webApp.charts[t+"Data"].dataTime=[];for(var n=1;e>n;n+=1)SurfInfo.webApp.charts[t+"Data"].dataHmax.push(r[n].hMax),SurfInfo.webApp.charts[t+"Data"].dataHs.push(r[n].hS),SurfInfo.webApp.charts[t+"Data"].dataTime.push(r[n].time);$(a[t+"Chart"]).highcharts({chart:{type:"areaspline"},title:{text:SurfInfo.webApp.charts[t+"Data"].data[0].day+"  "+SurfInfo.webApp.charts[t+"Data"].title||SurfInfo.webApp.charts[t+"Data"].title},xAxis:{categories:SurfInfo.webApp.charts[t+"Data"].dataTime},yAxis:{title:{text:"Height[meter]"}},tooltip:{shared:!0,valueSuffix:" meter"},credits:{enabled:!1},plotOptions:{areaspline:{fillOpacity:.5}},series:[{name:"גל מקסימלי",data:SurfInfo.webApp.charts[t+"Data"].dataHmax},{name:"גל ממוצע",data:SurfInfo.webApp.charts[t+"Data"].dataHs}]})},SurfInfo.communication={http:function(a,t){var e=$.Deferred();return $.ajax({url:a,crossDomain:!0,type:t,success:function(a){e.resolve(a)},error:function(a,t){e.reject(t)}}),e.promise()}},e=function(){var e,r,n,i;i=[],e=function(a,t){var e=a.find("td"),r={day:t||"",time:e.eq(0).text()||"-",hMax:parseFloat(e.eq(1).text())||"-",hS:parseFloat(e.eq(2).text())||"-",hThird:parseFloat(e.eq(3).text())||"-",direction:e.eq(4).text()||"-",tAv:e.eq(5).text()||"-",tZ:e.eq(6).text()||"-",tP:e.eq(7).text()||"-",temp:e.eq(8).text()};return r},r=function(a){var t=$.Deferred();return i.push(t.promise()),SurfInfo.communication.http(a,"GET").then(function(a){var r=[];$.each($(a).find("table").eq(0).find("tr"),function(t,n){r.push(e($(n),$(a).find("[size='+1']").eq(0).text()))}),t.resolve(r)},function(a){t.reject(a)}),t.promise()},n=function(e,r){var n=$(a[r+"Status"]+" .height"),i=$(a[r+"Status"]+" .date"),f=$(a[r+"Status"]+" .hour"),o=$(a[r+"Status"]+" .temp");SurfInfo.webApp.charts[r+"Data"].data=e,t(r),n.text(SurfInfo.webApp.charts[r+"Data"].dataHs[SurfInfo.webApp.charts[r+"Data"].dataHs.length-1]+"m - "+SurfInfo.webApp.charts[r+"Data"].dataHmax[SurfInfo.webApp.charts[r+"Data"].dataHmax.length-1]+"m"),i.text(SurfInfo.webApp.charts[r+"Data"].data[0].day),f.text(SurfInfo.webApp.charts[r+"Data"].dataTime[SurfInfo.webApp.charts[r+"Data"].dataTime.length-1]),o.html(SurfInfo.webApp.charts[r+"Data"].data[SurfInfo.webApp.charts[r+"Data"].data.length-1].temp+"&deg"),SurfInfo.webApp.charts[r+"Data"].loadingJq.hide()},r("/server/waves_prox.php?place=ashdod").then(function(a){n(a,"ashdod")}),r("/server/waves_prox.php?place=haifa").then(function(a){n(a,"haifa")}),SurfInfo.webApp.locationPath&&$.when.apply($,i).then(function(){SurfInfo.initCity()})},r=function(){var t=function(){var t,e=$(a.upperNav),r=e.find("li"),n=window.location.pathname.replace(/\//g,"");switch(SurfInfo.webApp.isMobile=!1,n.indexOf("mobile")>=0&&(SurfInfo.webApp.isMobile=!0,n=n.replace("mobile","")),SurfInfo.webApp.locationPath=n,e.find(".active").removeClass("active"),e.find(".ui-btn-active").removeClass("ui-btn-active ui-state-persist"),t=function(){SurfInfo.webApp.isMobile?this.find("a").addClass("ui-btn-active ui-state-persist"):this.tab("show")},n){case"Netanya":t.call(r.eq(2));break;case"Nahariya":t.call(r.eq(0));break;case"Haifa":t.call(r.eq(1));break;case"Herzliyya":t.call(r.eq(3));break;case"Tel-Aviv":t.call(r.eq(4));break;case"Ashdod":t.call(r.eq(5));break;default:t.call(r.eq(6))}};t(),SurfInfo.webApp.charts.ashdodData.loadingJq.show(),SurfInfo.webApp.charts.haifaData.loadingJq.show(),e()}()});