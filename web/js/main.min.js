$(function(){var a,t,e,e,r;a={ashdodChart:"#ashdodChart",haifaChart:"#haifaChart",ashdodStatus:".ashdodStatus",haifaStatus:".haifaStatus",upperNav:".upperNav"},SurfInfo.webApp={charts:{ashdodData:{loadingJq:$(".ashdodLoading"),title:"אשדוד",day:"",data:[]},haifaData:{loadingJq:$(".haifaLoading"),title:"חיפה",day:"",data:[]}}},t=function(t){var e=SurfInfo.webApp.charts[t+"Data"].data.length,r=SurfInfo.webApp.charts[t+"Data"].data;SurfInfo.webApp.charts[t+"Data"].dataHmax=[],SurfInfo.webApp.charts[t+"Data"].dataHs=[],SurfInfo.webApp.charts[t+"Data"].dataTime=[];for(var n=1;e>n;n+=1)SurfInfo.webApp.charts[t+"Data"].dataHmax.push(r[n].hMax),SurfInfo.webApp.charts[t+"Data"].dataHs.push(r[n].hS),SurfInfo.webApp.charts[t+"Data"].dataTime.push(r[n].time);$(a[t+"Chart"]).highcharts({chart:{type:"areaspline"},title:{text:SurfInfo.webApp.charts[t+"Data"].data[0].day+"  "+SurfInfo.webApp.charts[t+"Data"].title||SurfInfo.webApp.charts[t+"Data"].title},xAxis:{categories:SurfInfo.webApp.charts[t+"Data"].dataTime},yAxis:{title:{text:"Height[meter]"}},tooltip:{shared:!0,valueSuffix:" meter"},credits:{enabled:!1},plotOptions:{areaspline:{fillOpacity:.5}},series:[{name:"גל מקסימלי",data:SurfInfo.webApp.charts[t+"Data"].dataHmax},{name:"גל ממוצע",data:SurfInfo.webApp.charts[t+"Data"].dataHs}]})},SurfInfo.communication={http:function(a,t){var e=$.Deferred();return $.ajax({url:a,crossDomain:!0,type:t,success:function(a){e.resolve(a)}}),e.promise()}},e=function(){var e,r,n,o;o=[],e=function(a,t){var e=a.find("td"),r={day:t||"",time:e.eq(0).text()||"-",hMax:parseFloat(e.eq(1).text())||"-",hS:parseFloat(e.eq(2).text())||"-",hThird:parseFloat(e.eq(3).text())||"-",direction:e.eq(4).text()||"-",tAv:e.eq(5).text()||"-",tZ:e.eq(6).text()||"-",tP:e.eq(7).text()||"-",temp:e.eq(8).text()};return r},r=function(a){var t=$.Deferred();return o.push(t.promise()),SurfInfo.communication.http(a,"GET").then(function(a){var r=[];$.each($(a).find("table").eq(0).find("tr"),function(t,n){r.push(e($(n),$(a).find("[size='+1']").eq(0).text()))}),t.resolve(r)}),t.promise()},n=function(e,r){var n=$(a[r+"Status"]+" .height"),o=$(a[r+"Status"]+" .time");SurfInfo.webApp.charts[r+"Data"].data=e,t(r),n.text(SurfInfo.webApp.charts[r+"Data"].dataHs[SurfInfo.webApp.charts[r+"Data"].dataHs.length-1]+"m - "+SurfInfo.webApp.charts[r+"Data"].dataHmax[SurfInfo.webApp.charts[r+"Data"].dataHmax.length-1]+"m"),o.text(SurfInfo.webApp.charts[r+"Data"].dataTime[SurfInfo.webApp.charts[r+"Data"].dataTime.length-1]+","+SurfInfo.webApp.charts[r+"Data"].data[0].day),SurfInfo.webApp.charts[r+"Data"].loadingJq.hide()},r("/server/waves_prox.php?place=ashdod").then(function(a){n(a,"ashdod")}),r("/server/waves_prox.php?place=haifa").then(function(a){n(a,"haifa")}),SurfInfo.webApp.locationPath&&$.when.apply($,o).then(function(){SurfInfo.initCity()})},r=function(){var t=function(){var t=$(a.upperNav),e=t.find("li"),r=window.location.pathname.replace(/\//g,"");switch(SurfInfo.webApp.locationPath=r,t.find(".active").removeClass("active"),r){case"Netanya":e.eq(3).tab("show");break;case"Nahariya":e.eq(1).tab("show");break;case"Haifa":e.eq(2).tab("show");break;case"Herzliya":e.eq(4).tab("show");break;case"Tel-Aviv":e.eq(5).tab("show");break;case"Ashdod":e.eq(6).tab("show");break;default:e.eq(0).tab("show")}};t(),SurfInfo.webApp.charts.ashdodData.loadingJq.show(),SurfInfo.webApp.charts.haifaData.loadingJq.show(),e()}()});